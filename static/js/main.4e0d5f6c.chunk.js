(this["webpackJsonpbookmarks-client"]=this["webpackJsonpbookmarks-client"]||[]).push([[0],{298:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(26),o=n.n(c),s=n(28),i=n(308),l=n(313),u=n(181),d=n(32),j=n(309),b=n(314),f=n(301),m=n(302),O=n(310),p=n(304),h=n(187),x=n(319),g=n(186),v=n(188),y=n(132),k=n(185),C=n(168),w=n(169),T=n.n(w).a.create({baseURL:"https://api.bookmarks.am/api"}),S=n(125),I=n(30);function P(e,t){switch(t.type){case"drop":return Object(I.a)(Object(I.a)({},e),{},{page:1,total:0,docs:[]});case"list":return Object(I.a)(Object(I.a)({},e),t.payload);case"getTags":return Object(I.a)(Object(I.a)({},e),{},{tags:t.payload});case"add":return Object(I.a)(Object(I.a)({},e),{},{docs:[t.payload].concat(Object(S.a)(e.docs))});case"remove":return Object(I.a)(Object(I.a)({},e),{},{docs:e.docs.filter((function(e){return e._id!==t.payload._id}))});case"update":return Object(I.a)(Object(I.a)({},e),{},{docs:e.docs.map((function(e){return e._id===t.payload._id?t.payload:e}))});case"bulkRemove":return Object(I.a)(Object(I.a)({},e),{},{docs:e.docs.filter((function(e){return!t.payload.ids.includes(e._id)}))});case"bulkUpdate":return Object(I.a)(Object(I.a)({},e),{},{docs:e.docs.map((function(e){return t.payload.ids.includes(e._id)?Object.assign({},e,t.payload.data):e}))});default:throw new Error("".concat(t.type," not found!"))}}var B=n(6),z=Object(r.createContext)();function E(e){var t=e.children,n=function(){var e=Object(r.useReducer)(P,A),t=Object(s.a)(e,2),n=t[0],a=t[1];return{data:n,bulkRemove:function(e){return T.post("/bookmarks/bulk/delete",{ids:e}).then((function(){return a({type:"bulkRemove",payload:{ids:e}})})).catch((function(e){u.b.error(e.message)}))},bulkUpdate:function(e,t){return T.post("/bookmarks/bulk/update",{ids:e,data:t}).then((function(){return a({type:"bulkUpdate",payload:{ids:e,data:t}})})).catch((function(e){u.b.error(e.message)}))},getTags:function(){return T.get("/bookmarks/tags").then((function(e){return a({type:"getTags",payload:e.data})})).catch((function(e){u.b.error(e.message)}))},drop:function(){return T.delete("/bookmarks/").then((function(){return a({type:"drop"})})).catch((function(e){u.b.error(e.message)}))},add:function(e){return T.post("/bookmarks",e).then((function(e){return a({type:"add",payload:e.data})})).catch((function(e){u.b.error(e.message)}))},list:function(e){return T.get("/bookmarks",{params:e}).then((function(e){return a({type:"list",payload:e.data})})).catch((function(e){u.b.error(e.message)}))},update:function(e,t){return T.put("/bookmarks/".concat(e),t).then((function(e){return a({type:"update",payload:e.data})})).catch((function(e){u.b.error(e.message)}))},remove:function(e){return T.delete("/bookmarks/".concat(e)).then((function(){return a({type:"remove",payload:{_id:e}})})).catch((function(e){u.b.error(e.message)}))}}}();return Object(B.jsx)(z.Provider,{value:n,children:t})}function F(){return Object(r.useContext)(z)}var A={limit:0,total:0,tags:[],docs:[],page:1};var U=n(306),R=n(124),_=n(99),L=n(315),N=n(316),q=n(312),H=n(172),Y=new(n.n(H).a);function D(e){var t=e.label,n=e.onClick,a=e.onClose,c=Object(r.useMemo)((function(){return Y.hex(t)}),[t]);return Object(B.jsx)(q.a,{onClick:n,onClose:a,closable:!!a,color:c,style:{cursor:"pointer"},children:t})}function M(e){var t=Object(r.useState)(e.value),n=Object(s.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(!1),i=Object(s.a)(o,2),l=i[0],u=i[1],d=Object(r.useState)(""),j=Object(s.a)(d,2),b=j[0],f=j[1],m=Object(r.useRef)();Object(r.useEffect)((function(){e.onChange(a)}),[a]),Object(r.useEffect)((function(){var e;null===m||void 0===m||null===(e=m.current)||void 0===e||e.focus()}),[l]);var p=function(){b&&-1===a.indexOf(b)&&c([].concat(Object(S.a)(a),[b])),u(!1),f("")};return Object(B.jsxs)(B.Fragment,{children:[a.map((function(e){return Object(B.jsx)(D,{label:e,onClose:function(){return c(a.filter((function(t){return t!==e})))}},e)})),l&&Object(B.jsx)(O.a,{ref:m,type:"text",size:"small",style:{width:"78px",marginRight:"8px",verticalaAign:"top"},value:b,onChange:function(e){return f(e.target.value)},onBlur:p,onPressEnter:p}),!l&&Object(B.jsxs)(q.a,{style:{background:"#fff",borderStyle:"dashed"},onClick:function(){return u(!0)},children:[Object(B.jsx)(k.a,{})," New Tag"]})]})}function V(e){var t,n=U.a.useForm(),a=Object(s.a)(n,1)[0],c=Object(r.useState)(""),o=Object(s.a)(c,2),i=o[0],l=o[1],u=Object(r.useState)(!1),d=Object(s.a)(u,2),b=d[0],f=d[1],m=!(null===(t=e.record)||void 0===t?void 0:t._id);Object(r.useEffect)((function(){var t;a.setFieldsValue(e.record),l(null===(t=e.record)||void 0===t?void 0:t.type)}),[e.record,a]);return Object(B.jsx)(j.a,{title:m?"Add Bookmark":"Edit Bookmark",visible:!!e.record,onCancel:function(){return e.onCancel()},onOk:function(){return a.submit()},okText:"Submit",confirmLoading:b,destroyOnClose:!0,children:Object(B.jsxs)(U.a,{form:a,preserve:!1,layout:"vertical",onFinish:function(t){f(!0),m?e.onCreate(t).finally((function(t){return f(!1),e.onCancel(),t})):e.onUpdate(e.record._id,t).finally((function(t){return f(!1),e.onCancel(),t}))},children:[Object(B.jsx)(U.a.Item,{name:"type",style:{textAlign:"center"},children:Object(B.jsxs)(R.a.Group,{value:i,onChange:function(e){return l(e.target.value)},children:[Object(B.jsxs)(R.a.Button,{value:"site",children:[Object(B.jsx)(L.a,{})," Website"]}),Object(B.jsxs)(R.a.Button,{value:"book",children:[Object(B.jsx)(N.a,{})," Book"]})]})}),Object(B.jsx)(U.a.Item,{name:"name",label:"Name",rules:[{required:!0}],children:Object(B.jsx)(O.a,{placeholder:"6pm"})}),"book"===i&&Object(B.jsx)(U.a.Item,{name:"page",label:"Page",children:Object(B.jsx)(O.a,{placeholder:"14"})}),Object(B.jsx)(U.a.Item,{name:"url",label:"URL",rules:[{required:"site"===i}],children:Object(B.jsx)(O.a,{placeholder:"https://6pm.com"})}),Object(B.jsx)(U.a.Item,{name:"favorite",valuePropName:"checked",children:Object(B.jsx)(_.a,{children:"Favorite (Show First)"})}),Object(B.jsx)(U.a.Item,{name:"tags",label:"Tags",children:Object(B.jsx)(M,{})}),Object(B.jsx)(U.a.Item,{name:"notes",label:"Notes",children:Object(B.jsx)(O.a.TextArea,{placeholder:"Please don't write your password!"})})]})})}function J(e){var t=U.a.useForm(),n=Object(s.a)(t,1)[0],a=Object(r.useState)(!1),c=Object(s.a)(a,2),o=c[0],i=c[1];return Object(B.jsx)(j.a,{title:"Update Bookmarks",visible:e.visible,onCancel:function(){return e.onCancel()},onOk:function(){return n.submit()},okText:"Submit",confirmLoading:o,destroyOnClose:!0,children:Object(B.jsx)(U.a,{form:n,preserve:!1,layout:"vertical",onFinish:function(t){i(!0),e.onUpdate(e.selectedIds,t).finally((function(t){return i(!1),e.onCancel(),t}))},children:Object(B.jsx)(U.a.Item,{name:"tags",label:"Tags",initialValue:[],children:Object(B.jsx)(M,{})})})})}function K(e){var t=e.record;if(t.url){var n="example.com";try{n=new URL(t.url).hostname}catch(r){}return Object(B.jsxs)("a",{href:t.url,target:"_blank",rel:"noreferrer",children:[Object(B.jsx)("img",{style:{marginRight:8},alt:"Logo",width:"16",src:"https://www.google.com/s2/favicons?domain=".concat(n)}),t.name]})}return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(N.a,{style:{marginRight:8}}),t.name]})}var W=n(317),G=n(318);function Q(e){var t=e.record,n=e.onClick;return t.favorite?Object(B.jsx)(W.a,{onClick:function(){return n(Object(I.a)(Object(I.a)({},t),{},{favorite:!1}))},style:{color:"#eec35d",fontSize:16}}):Object(B.jsx)(G.a,{onClick:function(){return n(Object(I.a)(Object(I.a)({},t),{},{favorite:!0}))},style:{color:"#e6e2da",fontSize:16}})}var X=n(173),Z=n.n(X),$=i.a.Text;function ee(){var e,t,n=Object(r.useState)(null),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(1),w=Object(s.a)(i,2),T=w[0],S=w[1],I=Object(r.useState)(!1),P=Object(s.a)(I,2),z=P[0],E=P[1],A=Object(r.useState)(!1),U=Object(s.a)(A,2),R=U[0],_=U[1],L=Object(r.useState)([]),N=Object(s.a)(L,2),q=N[0],H=N[1],Y=Object(r.useState)(""),M=Object(s.a)(Y,2),W=M[0],G=M[1],X=F(),ee=Object(r.useCallback)(function(e,t,n){var r;return function(){var a=this,c=arguments,o=function(){r=null,n||e.apply(a,c)},s=n&&!r;clearTimeout(r),r=setTimeout(o,t),s&&e.apply(a,c)}}((function(e){return z||E(!0),X.list(e).finally((function(e){return E(!1),e}))}),300),[]);Object(r.useEffect)((function(){1!==T&&S(1),ee({search:W,page:1})}),[W]),Object(r.useEffect)((function(){ee({search:W,page:T})}),[T]),Object(r.useEffect)((function(){X.getTags()}),[]);var te=Object(r.useMemo)((function(){return[{title:"",width:40,align:"center",dataIndex:"favorite",key:"favorite",render:function(e,t){return Object(B.jsx)(Q,{record:t,onClick:function(e){return X.update(t._id,e)}})}},{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return Object(B.jsx)(K,{record:t})}},{title:"Notes",dataIndex:"notes",key:"notes"},{title:"Tags",key:"tags",dataIndex:"tags",render:function(e){return null===e||void 0===e?void 0:e.map((function(e){return Object(B.jsx)(D,{label:e,onClick:function(){return G(e)},isActive:W===e},e)}))}},{title:"",key:"action",align:"right",render:function(e,t){return Object(B.jsxs)(l.b,{children:[!!t.url&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(C.CopyToClipboard,{text:t.url,onCopy:function(){return u.b.success("Copied.")},children:Object(B.jsx)(d.a,{size:"small",icon:Object(B.jsx)(h.a,{})})}),Object(B.jsx)(d.a,{size:"small",icon:Object(B.jsx)(x.a,{}),onClick:function(){return j.a.info({icon:null,width:310,content:Object(B.jsx)(Z.a,{size:"240",renderAs:"svg",value:t.url})})}})]}),Object(B.jsx)(d.a,{size:"small",onClick:function(){return o(t)},icon:Object(B.jsx)(g.a,{})}),Object(B.jsx)(b.a,{okText:"Yes",cancelText:"No",destroyTooltipOnHide:!0,okButtonProps:{danger:!0},title:"Are you sure you want to delete this bookmark?",onConfirm:function(){return X.remove(t._id)},children:Object(B.jsx)(d.a,{size:"small",icon:Object(B.jsx)(v.a,{})})})]})}}]}),[]);return Object(B.jsxs)("div",{children:[Object(B.jsx)(V,{onCancel:function(){return o(null)},onUpdate:X.update,onCreate:X.add,record:c}),Object(B.jsx)(J,{visible:R,selectedIds:q,onCancel:function(){H([]),_(!1)},onUpdate:function(e,t){return X.bulkUpdate(e,t).then((function(e){return H([]),_(!1),e}))}}),Object(B.jsxs)(f.a,{style:{marginBottom:20},wrap:!1,children:[Object(B.jsx)(m.a,{flex:"auto",children:Object(B.jsx)(O.a,{bordered:!0,allowClear:!0,size:"large",value:W,placeholder:"Type name, tag, link...",prefix:Object(B.jsx)(y.a,{}),onChange:function(e){return G(e.target.value)}})}),Object(B.jsx)(m.a,{flex:"none",style:{paddingLeft:20},children:Object(B.jsx)(d.a,{icon:Object(B.jsx)(k.a,{}),size:"large",type:"primary",onClick:function(){return o({type:"site",tags:[]})},children:"Add Bookmark"})})]}),(null===(e=X.data)||void 0===e||null===(t=e.tags)||void 0===t?void 0:t.length)>0&&Object(B.jsxs)("div",{style:{marginBottom:20,lineHeight:"30px"},children:[Object(B.jsx)($,{children:"Filter By: "}),X.data.tags.map((function(e){return Object(B.jsx)(D,{label:e,onClick:function(){return G(e)},isActive:W===e},e)}))]}),q.length>1&&Object(B.jsxs)(l.b,{style:{marginBottom:20},children:[Object(B.jsxs)(d.a,{size:"middle",type:"primary",icon:Object(B.jsx)(g.a,{}),onClick:function(){return _(!0)},children:["Edit ",q.length," Items"]}),Object(B.jsx)(b.a,{okText:"Yes",cancelText:"No",destroyTooltipOnHide:!0,okButtonProps:{danger:!0},title:"Are you sure you want to delete the selected bookmarks? ",onConfirm:function(){return X.bulkRemove(q)},children:Object(B.jsxs)(d.a,{size:"middle",type:"primary",danger:!0,icon:Object(B.jsx)(v.a,{}),children:["Delete ",q.length," Items"]})})]}),Object(B.jsx)(p.a,{loading:z,columns:te,dataSource:X.data.docs,onChange:function(e){var t=e.current;return S(t)},rowKey:"_id",pagination:{current:T,showSizeChanger:!1,total:X.data.total,pageSize:X.data.limit},rowSelection:{onChange:H,selectedRowKeys:q},size:"small",scroll:{x:1},style:{whiteSpace:"nowrap"}})]})}var te=n(307),ne=n(311),re=n(177),ae=Object(r.createContext)();function ce(e){var t=e.children,n=function(){var e=Object(ne.a)(["user"]),t=Object(s.a)(e,3),n=t[0],a=t[1],c=t[2],o=Object(r.useState)(null),i=Object(s.a)(o,2),l=i[0],d=i[1];return Object(r.useEffect)((function(){var e={exp:0};try{var t;e=Object(re.a)(null===(t=n.user)||void 0===t?void 0:t.accessToken)}catch(o){}var r=(new Date).getTime()/1e3;if(e.exp>r){var a,c="Bearer ".concat(null===(a=n.user)||void 0===a?void 0:a.accessToken);T.defaults.headers.common.Authorization=c,d(n.user)}else T.defaults.headers.common.Authorization=void 0,d(null)}),[n.user]),{user:l,signin:function(e){return T.post("/auth/login",{email:e.email,password:e.password}).then((function(e){var t="Bearer ".concat(e.data.accessToken);T.defaults.headers.common.Authorization=t,d(e.data),a("user",e.data,{path:"/"})})).catch((function(e){u.b.error(e.message)}))},signup:function(e){return T.post("/auth/register",{email:e.email,password:e.password}).then((function(e){var t="Bearer ".concat(e.data.accessToken);T.defaults.headers.common.Authorization=t,d(e.data),a("user",e.data,{path:"/"})})).catch((function(e){u.b.error(e.message)}))},signout:function(){c("user"),d(null)}}}();return Object(B.jsx)(ae.Provider,{value:n,children:t})}function oe(){return Object(r.useContext)(ae)}var se=n(320),ie=n(321);function le(e){return Object(B.jsxs)(U.a,{layout:"vertical",style:{backgroundColor:"#fff",padding:20,marginTop:"-16px"},onFinish:function(t){return e.onFinish(t)},children:[Object(B.jsx)(U.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(B.jsx)(O.a,{placeholder:"Email",prefix:Object(B.jsx)(se.a,{})})}),Object(B.jsx)(U.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(B.jsx)(O.a.Password,{placeholder:"Password",prefix:Object(B.jsx)(ie.a,{}),type:"password"})}),Object(B.jsx)(U.a.Item,{children:Object(B.jsx)(d.a,{type:"primary",htmlType:"submit",children:"Sign In"})})]})}function ue(e){return Object(B.jsxs)(U.a,{layout:"vertical",style:{backgroundColor:"#fff",padding:20,marginTop:"-16px"},onFinish:function(t){return e.onFinish(t)},children:[Object(B.jsx)(U.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(B.jsx)(O.a,{placeholder:"Email",prefix:Object(B.jsx)(se.a,{})})}),Object(B.jsx)(U.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(B.jsx)(O.a.Password,{placeholder:"Password",prefix:Object(B.jsx)(ie.a,{})})}),Object(B.jsx)(U.a.Item,{name:"confirm",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("password")!==n?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(B.jsx)(O.a.Password,{placeholder:"Confirm Password",prefix:Object(B.jsx)(ie.a,{})})}),Object(B.jsx)(U.a.Item,{children:Object(B.jsx)(d.a,{type:"primary",htmlType:"submit",children:"Sign Up"})})]})}var de=i.a.Title,je=te.a.TabPane;function be(){var e=oe();return Object(B.jsxs)("div",{children:[Object(B.jsx)(de,{level:2,style:{marginBottom:25},children:"Sign In to Save Your Bookmarks!"}),Object(B.jsx)("div",{style:{overflow:"hidden",maxWidth:500},children:Object(B.jsxs)(te.a,{type:"card",children:[Object(B.jsx)(je,{tab:"Sign In",children:Object(B.jsx)(le,{onFinish:function(t){return e.signin(t)}})},"1"),Object(B.jsx)(je,{tab:"Sign Up",children:Object(B.jsx)(ue,{onFinish:function(t){return e.signup(t)}})},"2")]})})]})}var fe=n(303),me=n(126),Oe=n(76),pe=n(305),he=n(134);var xe=function(){var e,t=oe(),n=F(),a=Object(r.useRef)({});return t.user&&Object(B.jsx)(me.a,{overlay:Object(B.jsxs)(Oe.a,{children:[Object(B.jsx)(Oe.a.Item,{children:Object(B.jsx)(pe.a,{name:"bookmarks",multiple:!1,showUploadList:!1,accept:"application/html, text/html",action:T.defaults.baseURL.concat("/bookmarks/import"),headers:{authorization:T.defaults.headers.common.Authorization},onChange:function(e){"done"===e.file.status?(u.b.success("Your bookmarks imported successfully!"),n.list(),a.current.uploading=!1):"error"===e.file.status?(u.b.error("Your bookmarks import failed!"),a.current.uploading=!1):"uploading"===e.file.status&&(a.current.uploading||u.b.info("Please wait!"),a.current.uploading=!0)},children:"Import Bookmarks HTML"})}),Object(B.jsx)(Oe.a.Item,{onClick:function(){return j.a.confirm({title:"Are you sure to want to delete your bookmarks?",okButtonProps:{danger:!0},onOk:n.drop,okText:"Yes",cancelText:"No"})},children:"Delete Bookmarks"}),Object(B.jsx)(Oe.a.Item,{onClick:function(){return t.signout()},children:"Logout"})]}),children:Object(B.jsxs)("span",{style:{color:"#fff",cursor:"pointer"},onClick:function(e){return e.preventDefault()},children:[null===(e=t.user)||void 0===e?void 0:e.email," ",Object(B.jsx)(he.a,{})]})})};u.b.config({});var ge=function(){var e=oe();return Object(B.jsxs)(fe.a,{style:{minHeight:"100vh"},children:[Object(B.jsx)(fe.a.Header,{children:Object(B.jsxs)(f.a,{wrap:!1,children:[Object(B.jsx)(m.a,{flex:"auto",children:Object(B.jsx)(N.a,{style:{fontSize:20,color:"#fff"}})}),Object(B.jsx)(m.a,{flex:"none",children:Object(B.jsx)(xe,{})})]})}),Object(B.jsx)(fe.a.Content,{style:{padding:"50px 5%"},children:e.user?Object(B.jsx)(ee,{}):Object(B.jsx)(be,{})})]})};n(297);o.a.render(Object(B.jsx)(a.a.StrictMode,{children:Object(B.jsx)(ce,{children:Object(B.jsx)(E,{children:Object(B.jsx)(ge,{})})})}),document.getElementById("root"))}},[[298,1,2]]]);
//# sourceMappingURL=main.4e0d5f6c.chunk.js.map